---
import Hero from "../../components/Hero.astro";
import AboutUs from "../../components/AboutUs.tsx";
import Layout from "../../layouts/Layout.astro";
import Featured from "../../components/Featured";
import AllProjects from "../../components/AllProjects.tsx";
import CTA from "../../components/CTA.tsx";
import { projects } from "../../data/data.ts";

const { lang } = Astro.params;

// Validar el idioma
if (!lang || !['en', 'es'].includes(lang)) {
  return Astro.redirect('/es');
}
---

<Layout lang={lang}>
  <Hero lang={lang} />
  <AboutUs lang={lang} client:load />
  <Featured
    lang={lang}
    projects={projects
      .filter((project) => project.metadata.featured == true)
      .map((project) => ({
        ...project,
        metadata: {
          ...project.metadata,
          slug: project.slug
        }
      }))}
    client:load
  />
  <AllProjects lang={lang} projects={projects} client:load />
  <CTA lang={lang} client:load />
</Layout> 